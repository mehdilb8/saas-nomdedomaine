# ğŸ¯ PROMPT COMPLET - SaaS Monitoring Domaines ExpirÃ©s

## INSTRUCTIONS GÃ‰NÃ‰RALES POUR CLAUDE CODE

Tu es un dÃ©veloppeur senior Python/FastAPI. Tu dois dÃ©velopper une application complÃ¨te de monitoring de domaines expirÃ©s, de A Ã  Z, prÃªte pour la production et dÃ©ployÃ©e avec Docker.

### RÃ¨gles de travail OBLIGATOIRES

1. **Travail Ã©tape par Ã©tape** : Tu dois suivre les phases et sous-tÃ¢ches dans l'ordre exact
2. **Validation systÃ©matique** : AprÃ¨s chaque sous-tÃ¢che, afficher la checklist mise Ã  jour
3. **Pas de saut d'Ã©tape** : Ne jamais passer Ã  la phase suivante sans avoir validÃ© toutes les sous-tÃ¢ches de la phase actuelle
4. **Tests intermÃ©diaires** : Tester chaque composant avant de passer au suivant
5. **Commits rÃ©guliers** : Faire un commit Git Ã  la fin de chaque phase validÃ©e

### Format de mise Ã  jour de la checklist

AprÃ¨s chaque sous-tÃ¢che complÃ©tÃ©e, afficher :

```
âœ… SOUS-TÃ‚CHE COMPLÃ‰TÃ‰E : [nom de la sous-tÃ¢che]

ğŸ“‹ CHECKLIST MISE Ã€ JOUR :
==========================
PHASE 1 : Setup & Infrastructure [X/14]
  [x] 1.1 - CrÃ©er structure dossiers
  [x] 1.2 - Initialiser Git
  [ ] 1.3 - CrÃ©er requirements.txt
  ...

PROGRESSION GLOBALE : X/89 tÃ¢ches (XX%)
```

---

# SECTION 1 : CONTEXTE DU PROJET

## 1.1 Description fonctionnelle

Application SaaS personnelle pour :
- Surveiller la disponibilitÃ© de noms de domaine expirÃ©s
- Recevoir des notifications Discord quand ils deviennent disponibles Ã  l'achat
- GÃ©rer une liste de domaines Ã  surveiller via API REST

## 1.2 Environnement de dÃ©ploiement

| ParamÃ¨tre | Valeur |
|-----------|--------|
| Serveur | VPS OVH |
| Ressources | 8 vCores, 24 Go RAM, 200 Go SSD NVMe |
| OS | Ubuntu 22.04+ |
| DÃ©ploiement | Docker + Docker Compose |
| Port application | 3010 |
| Port phpMyAdmin | 8083 |
| Port MySQL | 3307 (interne Docker, pas exposÃ© publiquement) |
| Ports occupÃ©s (ne pas utiliser) | 22, 3306, 5000, 5001, 5432, 6379, 8000, 8082 |

## 1.3 SpÃ©cifications fonctionnelles dÃ©taillÃ©es

### EntrÃ©es utilisateur par domaine

| Champ | Type | Requis | Description |
|-------|------|--------|-------------|
| domain | string | âœ… | Nom de domaine complet (ex: example.fr) |
| niche | string | âŒ | ThÃ©matique ou vertical du domaine |
| traffic | integer | âŒ | Estimation du trafic historique |
| referring_domains | integer | âŒ | Nombre de Referring Domains (RD) |

### RÃ¨gles mÃ©tier

1. **VÃ©rification DNS** : DÃ©terminer si un domaine est disponible via requÃªte DNS
2. **Double vÃ©rification** : Si disponible â†’ attendre 5 secondes â†’ re-vÃ©rifier avec serveur DNS diffÃ©rent
3. **Anti-spam notifications** : Ne PAS notifier si le domaine Ã©tait dÃ©jÃ  disponible au check prÃ©cÃ©dent
4. **FrÃ©quence** : VÃ©rification automatique toutes les 2 heures
5. **Extensions supportÃ©es** : .fr, .com, .net (extensible)

### Logique de dÃ©tection DNS

| RÃ©ponse DNS | InterprÃ©tation | Action |
|-------------|----------------|--------|
| NXDOMAIN | Domaine disponible | Double vÃ©rification |
| SERVFAIL (aprÃ¨s retries) | Probablement disponible | Double vÃ©rification |
| Timeout (aprÃ¨s retries) | Incertain | Retry, puis skip |
| RÃ©ponse avec IP | Non disponible | Marquer unavailable |

### Notifications Discord

- **DÃ©clencheur** : Uniquement sur transition `unavailable` â†’ `available`
- **Format** : Embed Discord riche avec couleur verte
- **Contenu** : Domaine, TLD, niche, traffic, RD, timestamp

---

# SECTION 2 : STACK TECHNIQUE

## 2.1 Technologies imposÃ©es

| Composant | Technologie | Version | Justification |
|-----------|-------------|---------|---------------|
| Runtime | Python | 3.12 | Performance, Ã©cosystÃ¨me riche |
| Framework API | FastAPI | â‰¥0.109 | Async natif, auto-doc, rapide |
| ORM | SQLAlchemy | â‰¥2.0 | Standard Python, async support |
| Base de donnÃ©es | MySQL | 8.0 | Robuste, performant, standard |
| Admin BDD | phpMyAdmin | latest | Interface web pour gÃ©rer MySQL |
| Scheduler | APScheduler | â‰¥3.10 | Robuste, async, in-process |
| DNS | dnspython | â‰¥2.5 | Librairie de rÃ©fÃ©rence Python |
| HTTP Client | httpx | â‰¥0.26 | Async, moderne |
| Validation | Pydantic | v2 | IntÃ©grÃ© FastAPI, type-safe |
| Logs | Loguru | â‰¥0.7 | Simple, rotation auto, formatage Ã©lÃ©gant |
| Tests | Pytest | â‰¥8.0 | Standard Python |
| Conteneurisation | Docker | latest | Isolation, dÃ©ploiement simplifiÃ© |

## 2.2 DÃ©pendances complÃ¨tes (requirements.txt)

```
# Core
fastapi>=0.109.0
uvicorn[standard]>=0.27.0
pydantic>=2.0.0
pydantic-settings>=2.0.0

# Database MySQL
sqlalchemy>=2.0.0
aiomysql>=0.2.0
pymysql>=1.1.0
cryptography>=42.0.0

# DNS
dnspython>=2.5.0

# HTTP
httpx>=0.26.0

# Scheduler
apscheduler>=3.10.0

# Logging
loguru>=0.7.0

# Testing
pytest>=8.0.0
pytest-asyncio>=0.23.0
pytest-cov>=4.1.0

# Dev
black>=24.0.0
isort>=5.13.0
```

---

# SECTION 3 : ARCHITECTURE

## 3.1 Structure des fichiers

```
saas-nomdedomaine/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                      # Point d'entrÃ©e FastAPI
â”‚   â”œâ”€â”€ config.py                    # Configuration Pydantic Settings
â”‚   â”œâ”€â”€ database.py                  # Connexion MySQL async
â”‚   â”œâ”€â”€ models.py                    # ModÃ¨les SQLAlchemy
â”‚   â”œâ”€â”€ schemas.py                   # SchÃ©mas Pydantic (validation)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ dns_checker.py           # VÃ©rification DNS async
â”‚   â”‚   â”œâ”€â”€ availability.py          # Orchestration vÃ©rification
â”‚   â”‚   â”œâ”€â”€ notification.py          # Envoi Discord webhook
â”‚   â”‚   â””â”€â”€ scheduler.py             # Configuration APScheduler
â”‚   â”‚
â”‚   â””â”€â”€ routers/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ domains.py               # Routes API domaines
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py                  # Fixtures pytest
â”‚   â”œâ”€â”€ test_dns_checker.py
â”‚   â”œâ”€â”€ test_availability.py
â”‚   â””â”€â”€ test_api.py
â”‚
â”œâ”€â”€ mysql_data/
â”‚   â””â”€â”€ .gitkeep                     # Dossier MySQL (volume Docker)
â”‚
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ .gitkeep                     # Dossier logs (volume Docker)
â”‚
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ Dockerfile
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ init.sql                     # Script d'initialisation MySQL
â”‚   â””â”€â”€ seed.py                      # Script pour donnÃ©es de test
â”‚
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env.example
â”œâ”€â”€ .env                             # (gitignored)
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ DEPLOYMENT.md
```

## 3.2 Architecture Docker (3 services)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DOCKER COMPOSE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    APP      â”‚    â”‚   MySQL     â”‚    â”‚    phpMyAdmin       â”‚  â”‚
â”‚  â”‚  FastAPI    â”‚â”€â”€â”€â–¶â”‚    8.0      â”‚â—€â”€â”€â”€â”‚                     â”‚  â”‚
â”‚  â”‚  Port 3010  â”‚    â”‚  Port 3307  â”‚    â”‚    Port 8083        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                   â”‚                     â”‚               â”‚
â”‚        â–¼                   â–¼                     â–¼               â”‚
â”‚   ./logs:/app/logs   mysql_data:/var/lib/mysql   (stateless)    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3.3 SchÃ©ma de base de donnÃ©es MySQL

### Table : domains

```sql
CREATE TABLE domains (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain VARCHAR(255) NOT NULL UNIQUE,
    tld VARCHAR(10) NOT NULL,
    niche VARCHAR(100) NULL,
    traffic INT DEFAULT 0,
    referring_domains INT DEFAULT 0,
    status ENUM('available', 'unavailable', 'unknown') DEFAULT 'unknown',
    previous_status ENUM('available', 'unavailable', 'unknown') DEFAULT 'unknown',
    last_checked DATETIME NULL,
    last_available DATETIME NULL,
    is_active BOOLEAN DEFAULT TRUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_is_active (is_active),
    INDEX idx_status (status),
    INDEX idx_tld (tld)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### Table : check_logs

```sql
CREATE TABLE check_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain_id INT NOT NULL,
    status_found ENUM('available', 'unavailable', 'error') NOT NULL,
    check_method VARCHAR(20) NOT NULL,
    response_time_ms INT NULL,
    error_message TEXT NULL,
    notification_sent BOOLEAN DEFAULT FALSE,
    checked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_domain_id (domain_id),
    INDEX idx_checked_at (checked_at),
    
    FOREIGN KEY (domain_id) REFERENCES domains(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### Table : notifications

```sql
CREATE TABLE notifications (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain_id INT NOT NULL,
    webhook_response TEXT NULL,
    http_status INT NULL,
    success BOOLEAN DEFAULT FALSE,
    sent_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_domain_id (domain_id),
    
    FOREIGN KEY (domain_id) REFERENCES domains(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

### Script d'initialisation complet (scripts/init.sql)

```sql
-- ============================================
-- DOMAIN MONITOR - INITIALISATION BASE DE DONNÃ‰ES
-- ============================================

-- CrÃ©ation de la base de donnÃ©es (si pas dÃ©jÃ  crÃ©Ã©e par Docker)
CREATE DATABASE IF NOT EXISTS domain_monitor
    CHARACTER SET utf8mb4
    COLLATE utf8mb4_unicode_ci;

USE domain_monitor;

-- ============================================
-- TABLE: domains
-- ============================================
CREATE TABLE IF NOT EXISTS domains (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain VARCHAR(255) NOT NULL UNIQUE COMMENT 'Nom de domaine complet (ex: example.fr)',
    tld VARCHAR(10) NOT NULL COMMENT 'Extension du domaine (.fr, .com, .net)',
    niche VARCHAR(100) NULL COMMENT 'ThÃ©matique du domaine',
    traffic INT DEFAULT 0 COMMENT 'Estimation du trafic mensuel',
    referring_domains INT DEFAULT 0 COMMENT 'Nombre de referring domains (backlinks)',
    status ENUM('available', 'unavailable', 'unknown') DEFAULT 'unknown' COMMENT 'Statut actuel',
    previous_status ENUM('available', 'unavailable', 'unknown') DEFAULT 'unknown' COMMENT 'Statut prÃ©cÃ©dent (pour dÃ©tecter les transitions)',
    last_checked DATETIME NULL COMMENT 'Date de derniÃ¨re vÃ©rification',
    last_available DATETIME NULL COMMENT 'Date de derniÃ¨re disponibilitÃ© dÃ©tectÃ©e',
    is_active BOOLEAN DEFAULT TRUE COMMENT 'Monitoring actif/inactif',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_is_active (is_active),
    INDEX idx_status (status),
    INDEX idx_tld (tld),
    INDEX idx_last_checked (last_checked)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ============================================
-- TABLE: check_logs
-- ============================================
CREATE TABLE IF NOT EXISTS check_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain_id INT NOT NULL,
    status_found ENUM('available', 'unavailable', 'error') NOT NULL COMMENT 'RÃ©sultat de la vÃ©rification',
    check_method VARCHAR(20) NOT NULL COMMENT 'MÃ©thode utilisÃ©e (dns_primary, dns_secondary)',
    response_time_ms INT NULL COMMENT 'Temps de rÃ©ponse en millisecondes',
    error_message TEXT NULL COMMENT 'Message d erreur si applicable',
    notification_sent BOOLEAN DEFAULT FALSE COMMENT 'Notification Discord envoyÃ©e',
    checked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_domain_id (domain_id),
    INDEX idx_checked_at (checked_at),
    INDEX idx_status_found (status_found),
    
    FOREIGN KEY (domain_id) REFERENCES domains(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ============================================
-- TABLE: notifications
-- ============================================
CREATE TABLE IF NOT EXISTS notifications (
    id INT AUTO_INCREMENT PRIMARY KEY,
    domain_id INT NOT NULL,
    webhook_response TEXT NULL COMMENT 'RÃ©ponse brute du webhook Discord',
    http_status INT NULL COMMENT 'Code HTTP retournÃ©',
    success BOOLEAN DEFAULT FALSE COMMENT 'Envoi rÃ©ussi ou non',
    sent_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_domain_id (domain_id),
    INDEX idx_sent_at (sent_at),
    INDEX idx_success (success),
    
    FOREIGN KEY (domain_id) REFERENCES domains(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ============================================
-- PROCÃ‰DURE: Nettoyage des vieux logs (> 30 jours)
-- ============================================
DELIMITER //
CREATE PROCEDURE IF NOT EXISTS cleanup_old_logs()
BEGIN
    DELETE FROM check_logs WHERE checked_at < DATE_SUB(NOW(), INTERVAL 30 DAY);
    DELETE FROM notifications WHERE sent_at < DATE_SUB(NOW(), INTERVAL 90 DAY);
END //
DELIMITER ;

-- ============================================
-- EVENT: Nettoyage automatique quotidien
-- ============================================
SET GLOBAL event_scheduler = ON;

CREATE EVENT IF NOT EXISTS daily_cleanup
ON SCHEDULE EVERY 1 DAY
STARTS CURRENT_TIMESTAMP
DO CALL cleanup_old_logs();
```

## 3.4 Endpoints API REST

### Endpoints de santÃ© et statistiques

| MÃ©thode | Endpoint | Description | RÃ©ponse |
|---------|----------|-------------|---------|
| GET | /api/health | Health check Docker | `{"status": "healthy", "database": "connected", "timestamp": "..."}` |
| GET | /api/stats | Statistiques globales | Voir dÃ©tail ci-dessous |

#### RÃ©ponse GET /api/stats

```json
{
  "total_domains": 150,
  "active_domains": 145,
  "by_status": {
    "available": 12,
    "unavailable": 130,
    "unknown": 8
  },
  "by_tld": {
    "fr": 80,
    "com": 50,
    "net": 20
  },
  "last_check_cycle": "2025-01-19T14:00:00Z",
  "next_check_cycle": "2025-01-19T16:00:00Z",
  "notifications_today": 3
}
```

### Endpoints CRUD domaines

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | /api/domains | Lister tous les domaines (avec pagination et filtres) |
| GET | /api/domains/{id} | DÃ©tails d'un domaine + 10 derniers checks |
| POST | /api/domains | Ajouter un nouveau domaine |
| PUT | /api/domains/{id} | Modifier un domaine existant |
| DELETE | /api/domains/{id} | Supprimer un domaine |
| POST | /api/domains/{id}/check | Forcer vÃ©rification immÃ©diate |
| PATCH | /api/domains/{id}/toggle | Activer/dÃ©sactiver monitoring |

### ParamÃ¨tres GET /api/domains

| ParamÃ¨tre | Type | Description |
|-----------|------|-------------|
| status | string | Filtrer par status (available, unavailable, unknown) |
| tld | string | Filtrer par extension (fr, com, net) |
| is_active | boolean | Filtrer par Ã©tat monitoring |
| search | string | Recherche dans le nom de domaine |
| limit | integer | Nombre de rÃ©sultats (default: 50, max: 200) |
| offset | integer | Pagination offset (default: 0) |
| sort_by | string | Champ de tri (created_at, last_checked, domain) |
| sort_order | string | Ordre de tri (asc, desc) |

### SchÃ©mas Pydantic

#### DomainCreate (POST /api/domains)

```python
{
  "domain": "example.fr",           # requis, regex validÃ©
  "niche": "Tech",                  # optionnel, max 100 chars
  "traffic": 5000,                  # optionnel, >= 0
  "referring_domains": 150          # optionnel, >= 0
}
```

#### DomainUpdate (PUT /api/domains/{id})

```python
{
  "niche": "Finance",               # optionnel
  "traffic": 8000,                  # optionnel
  "referring_domains": 200          # optionnel
}
```

#### DomainResponse

```python
{
  "id": 1,
  "domain": "example.fr",
  "tld": "fr",
  "niche": "Tech",
  "traffic": 5000,
  "referring_domains": 150,
  "status": "unavailable",
  "previous_status": "unknown",
  "last_checked": "2025-01-19T14:30:00Z",
  "last_available": null,
  "is_active": true,
  "created_at": "2025-01-19T10:00:00Z",
  "updated_at": "2025-01-19T14:30:00Z"
}
```

## 3.5 Configuration environnement

### Fichier .env.example

```bash
# ===================================
# APPLICATION
# ===================================
APP_NAME=domain-monitor
APP_ENV=production
APP_DEBUG=false
APP_HOST=0.0.0.0
APP_PORT=3010

# ===================================
# DATABASE MYSQL
# ===================================
MYSQL_HOST=mysql
MYSQL_PORT=3306
MYSQL_DATABASE=domain_monitor
MYSQL_USER=domain_user
MYSQL_PASSWORD=your_secure_password_here
MYSQL_ROOT_PASSWORD=your_root_password_here

# URL de connexion (construite automatiquement)
DATABASE_URL=mysql+aiomysql://${MYSQL_USER}:${MYSQL_PASSWORD}@${MYSQL_HOST}:${MYSQL_PORT}/${MYSQL_DATABASE}

# ===================================
# PHPMYADMIN
# ===================================
PMA_HOST=mysql
PMA_PORT=3306

# ===================================
# LOGGING
# ===================================
LOG_LEVEL=INFO
LOG_PATH=./logs
LOG_ROTATION=10 MB
LOG_RETENTION=30 days

# ===================================
# DISCORD
# ===================================
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN
DISCORD_RETRY_COUNT=3
DISCORD_RETRY_DELAY=2

# ===================================
# SCHEDULER
# ===================================
CHECK_INTERVAL_HOURS=2
BATCH_SIZE=50
DELAY_BETWEEN_CHECKS_MS=100
DOUBLE_CHECK_DELAY_SECONDS=5

# ===================================
# DNS
# ===================================
DNS_TIMEOUT_SECONDS=5
DNS_RETRY_COUNT=2
DNS_PRIMARY_SERVER=8.8.8.8
DNS_SECONDARY_SERVER=1.1.1.1

# ===================================
# SUPPORTED TLDs
# ===================================
SUPPORTED_TLDS=fr,com,net
```

---

# SECTION 4 : LOGIQUE MÃ‰TIER DÃ‰TAILLÃ‰E

## 4.1 Service DNS Checker

### Fonction check_domain_availability(domain: str, dns_server: str) -> CheckResult

```
ENTRÃ‰E: domain (str), dns_server (str)
SORTIE: CheckResult(available: bool, method: str, response_time_ms: int, error: str|None)

ALGORITHME:
1. CrÃ©er resolver DNS avec timeout configurÃ©
2. Configurer le serveur DNS spÃ©cifiÃ©
3. TRY (max DNS_RETRY_COUNT tentatives):
   a. DÃ©marrer chronomÃ¨tre
   b. RÃ©soudre le domaine (type A)
   c. ArrÃªter chronomÃ¨tre
   d. SI rÃ©ponse contient des IP:
      - RETOURNER CheckResult(available=False, ...)
4. CATCH NXDOMAIN:
   - RETOURNER CheckResult(available=True, ...)
5. CATCH (Timeout, NoNameservers, SERVFAIL):
   - SI tentatives restantes > 0: RETRY
   - SINON: RETOURNER CheckResult(available=True, error="timeout/servfail")
6. CATCH Exception:
   - Logger l'erreur
   - RETOURNER CheckResult(available=None, error=str(exception))
```

## 4.2 Service Availability

### Fonction verify_domain(domain: Domain) -> VerificationResult

```
ENTRÃ‰E: domain (Domain model)
SORTIE: VerificationResult(is_available: bool, should_notify: bool, check_logs: list)

ALGORITHME:
1. Sauvegarder previous_status = domain.status

2. PREMIÃˆRE VÃ‰RIFICATION (DNS primaire):
   a. result1 = check_domain_availability(domain.domain, DNS_PRIMARY_SERVER)
   b. Logger le rÃ©sultat
   c. SI result1.available == False:
      - Mettre Ã  jour domain.status = "unavailable"
      - RETOURNER VerificationResult(is_available=False, should_notify=False)

3. SI result1.available == True:
   a. Attendre DOUBLE_CHECK_DELAY_SECONDS (5 secondes)
   
   b. DEUXIÃˆME VÃ‰RIFICATION (DNS secondaire):
      - result2 = check_domain_availability(domain.domain, DNS_SECONDARY_SERVER)
      - Logger le rÃ©sultat
   
   c. SI result2.available == True:
      - Mettre Ã  jour domain.status = "available"
      - Mettre Ã  jour domain.last_available = now()
      
      - DÃ‰TERMINER SI NOTIFICATION NÃ‰CESSAIRE:
        * SI previous_status != "available":
          â†’ should_notify = True (TRANSITION DÃ‰TECTÃ‰E)
        * SINON:
          â†’ should_notify = False (ANTI-SPAM)
      
      - RETOURNER VerificationResult(is_available=True, should_notify=should_notify)
   
   d. SI result2.available == False:
      - Mettre Ã  jour domain.status = "unavailable"
      - RETOURNER VerificationResult(is_available=False, should_notify=False)

4. Mettre Ã  jour domain.last_checked = now()
5. Mettre Ã  jour domain.previous_status = previous_status
6. Sauvegarder en base de donnÃ©es
```

## 4.3 Service Notification

### Fonction send_discord_notification(domain: Domain) -> NotificationResult

```
ENTRÃ‰E: domain (Domain model)
SORTIE: NotificationResult(success: bool, http_status: int, response: str)

ALGORITHME:
1. Construire l'embed Discord:
   {
     "embeds": [{
       "title": "ğŸ¯ Domaine disponible !",
       "color": 65280,  # Vert (#00FF00)
       "fields": [
         {"name": "ğŸ“ Domaine", "value": domain.domain, "inline": true},
         {"name": "ğŸ·ï¸ TLD", "value": domain.tld, "inline": true},
         {"name": "ğŸ“‚ Niche", "value": domain.niche or "Non dÃ©finie", "inline": true},
         {"name": "ğŸ“Š Traffic", "value": format_number(domain.traffic), "inline": true},
         {"name": "ğŸ”— Referring Domains", "value": format_number(domain.referring_domains), "inline": true}
       ],
       "footer": {"text": "Domain Monitor"},
       "timestamp": datetime.utcnow().isoformat()
     }]
   }

2. POUR i DE 1 Ã€ DISCORD_RETRY_COUNT:
   a. TRY:
      - response = httpx.post(DISCORD_WEBHOOK_URL, json=embed, timeout=10)
      - SI response.status_code == 204:
        * Logger succÃ¨s
        * Enregistrer en base (notifications)
        * RETOURNER NotificationResult(success=True, http_status=204)
      - SI response.status_code == 429 (rate limit):
        * Attendre retry_after secondes
        * CONTINUER
   b. CATCH Exception:
      - Logger erreur
      - Attendre DISCORD_RETRY_DELAY * i secondes
      - CONTINUER

3. Logger Ã©chec total
4. RETOURNER NotificationResult(success=False, ...)
```

## 4.4 Service Scheduler

### Fonction run_check_cycle()

```
ALGORITHME:
1. Logger "ğŸš€ DÃ©but du cycle de vÃ©rification"
2. RÃ©cupÃ©rer start_time = now()

3. RÃ©cupÃ©rer tous les domaines actifs:
   domains = SELECT * FROM domains WHERE is_active = TRUE

4. Initialiser compteurs:
   - total = len(domains)
   - checked = 0
   - available_count = 0
   - notifications_sent = 0

5. Diviser en batches de BATCH_SIZE domaines

6. POUR chaque batch:
   POUR chaque domain dans batch:
     a. result = verify_domain(domain)
     b. checked += 1
     
     c. SI result.is_available:
        available_count += 1
        
        SI result.should_notify:
          notif_result = send_discord_notification(domain)
          SI notif_result.success:
            notifications_sent += 1
     
     d. CrÃ©er check_log en base de donnÃ©es
     
     e. Attendre DELAY_BETWEEN_CHECKS_MS millisecondes

7. Calculer duration = now() - start_time

8. Logger rÃ©sumÃ©:
   "âœ… Cycle terminÃ© en {duration}s"
   "ğŸ“Š {checked}/{total} domaines vÃ©rifiÃ©s"
   "ğŸŸ¢ {available_count} disponibles"
   "ğŸ“¨ {notifications_sent} notifications envoyÃ©es"

9. Appeler la procÃ©dure MySQL cleanup_old_logs() si besoin
```

### Configuration APScheduler

```python
scheduler = AsyncIOScheduler(timezone="Europe/Paris")

scheduler.add_job(
    run_check_cycle,
    trigger=IntervalTrigger(hours=CHECK_INTERVAL_HOURS),
    id="domain_check_cycle",
    name="VÃ©rification des domaines",
    replace_existing=True,
    max_instances=1,  # Ã‰viter les exÃ©cutions parallÃ¨les
    coalesce=True     # Fusionner les jobs manquÃ©s
)
```

---

# SECTION 5 : DOCKER

## 5.1 Dockerfile (app)

```dockerfile
# ================================
# Stage 1: Builder
# ================================
FROM python:3.12-slim as builder

WORKDIR /build

# Install build dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
    gcc \
    default-libmysqlclient-dev \
    pkg-config \
    && rm -rf /var/lib/apt/lists/*

# Install Python dependencies
COPY requirements.txt .
RUN pip wheel --no-cache-dir --no-deps --wheel-dir /build/wheels -r requirements.txt

# ================================
# Stage 2: Production
# ================================
FROM python:3.12-slim as production

# Create non-root user
RUN groupadd -r appgroup && useradd -r -g appgroup appuser

WORKDIR /app

# Install runtime dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
    curl \
    default-libmysqlclient-dev \
    && rm -rf /var/lib/apt/lists/*

# Copy wheels from builder
COPY --from=builder /build/wheels /wheels
RUN pip install --no-cache-dir /wheels/* && rm -rf /wheels

# Copy application code
COPY app/ ./app/

# Create directories for volumes
RUN mkdir -p /app/logs && \
    chown -R appuser:appgroup /app

# Switch to non-root user
USER appuser

# Environment variables
ENV PYTHONUNBUFFERED=1 \
    PYTHONDONTWRITEBYTECODE=1 \
    APP_HOST=0.0.0.0 \
    APP_PORT=3010

# Expose port
EXPOSE 3010

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:3010/api/health || exit 1

# Start application
CMD ["python", "-m", "uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "3010"]
```

## 5.2 docker-compose.yml

```yaml
version: '3.8'

services:
  # ================================
  # APPLICATION FASTAPI
  # ================================
  app:
    build:
      context: .
      dockerfile: docker/Dockerfile
    container_name: domain-monitor-app
    restart: unless-stopped
    ports:
      - "3010:3010"
    volumes:
      - ./logs:/app/logs
    env_file:
      - .env
    environment:
      - TZ=Europe/Paris
    depends_on:
      mysql:
        condition: service_healthy
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3010/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    networks:
      - domain-monitor-network

  # ================================
  # BASE DE DONNÃ‰ES MYSQL
  # ================================
  mysql:
    image: mysql:8.0
    container_name: domain-monitor-mysql
    restart: unless-stopped
    ports:
      - "3307:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./scripts/init.sql:/docker-entrypoint-initdb.d/init.sql:ro
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}
      TZ: Europe/Paris
    command:
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
      - --default-authentication-plugin=mysql_native_password
      - --event-scheduler=ON
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost", "-u", "root", "-p${MYSQL_ROOT_PASSWORD}"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 30s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    networks:
      - domain-monitor-network

  # ================================
  # PHPMYADMIN
  # ================================
  phpmyadmin:
    image: phpmyadmin:latest
    container_name: domain-monitor-phpmyadmin
    restart: unless-stopped
    ports:
      - "8083:80"
    environment:
      PMA_HOST: mysql
      PMA_PORT: 3306
      PMA_USER: root
      PMA_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      UPLOAD_LIMIT: 50M
    depends_on:
      mysql:
        condition: service_healthy
    networks:
      - domain-monitor-network

# ================================
# VOLUMES
# ================================
volumes:
  mysql_data:
    name: domain-monitor-mysql-data

# ================================
# NETWORKS
# ================================
networks:
  domain-monitor-network:
    name: domain-monitor-network
    driver: bridge
```

## 5.3 .dockerignore

```
# Git
.git
.gitignore

# Python
__pycache__
*.py[cod]
*$py.class
.Python
*.so
.venv
venv
ENV

# Testing
.pytest_cache
.coverage
htmlcov
.tox

# IDE
.idea
.vscode
*.swp
*.swo

# Environment
.env
.env.local
.env.*.local

# Logs
logs/*.log

# MySQL data (managed by Docker volume)
mysql_data/

# Documentation
*.md
!README.md

# Docker
Dockerfile
docker-compose*.yml

# Misc
.DS_Store
Thumbs.db
```

---

# SECTION 6 : CHECKLIST DE DÃ‰VELOPPEMENT

## MASTER CHECKLIST

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    CHECKLIST DÃ‰VELOPPEMENT - DOMAIN MONITOR                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Progression globale : [ ] 0/89 tÃ¢ches (0%)                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1 : SETUP & INFRASTRUCTURE                              [0/15] â¬œ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 1.1   CrÃ©er le dossier racine 'saas-nomdedomaine'                        â”‚
â”‚ [ ] 1.2   CrÃ©er la structure complÃ¨te des dossiers (app/, tests/, etc.)      â”‚
â”‚ [ ] 1.3   Initialiser Git (git init)                                         â”‚
â”‚ [ ] 1.4   CrÃ©er le fichier .gitignore complet                                â”‚
â”‚ [ ] 1.5   CrÃ©er le fichier requirements.txt                                  â”‚
â”‚ [ ] 1.6   CrÃ©er le fichier .env.example                                      â”‚
â”‚ [ ] 1.7   CrÃ©er le fichier .env (copie de .env.example avec vraies valeurs)  â”‚
â”‚ [ ] 1.8   CrÃ©er app/__init__.py                                              â”‚
â”‚ [ ] 1.9   CrÃ©er app/config.py (Pydantic Settings)                            â”‚
â”‚ [ ] 1.10  CrÃ©er les fichiers .gitkeep dans mysql_data/ et logs/              â”‚
â”‚ [ ] 1.11  CrÃ©er scripts/init.sql (initialisation MySQL)                      â”‚
â”‚ [ ] 1.12  CrÃ©er docker/Dockerfile                                            â”‚
â”‚ [ ] 1.13  CrÃ©er docker-compose.yml (app + mysql + phpmyadmin)                â”‚
â”‚ [ ] 1.14  CrÃ©er .dockerignore                                                â”‚
â”‚ [ ] 1.15  COMMIT: "chore: initial project setup with MySQL"                  â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 1:                                            â”‚
â”‚   - Structure de dossiers complÃ¨te                                           â”‚
â”‚   - docker compose config valide (pas d'erreur)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2 : BASE DE DONNÃ‰ES MYSQL                               [0/10] â¬œ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 2.1   CrÃ©er app/database.py (connexion async MySQL avec aiomysql)        â”‚
â”‚ [ ] 2.2   CrÃ©er app/models.py - modÃ¨le Domain                                â”‚
â”‚ [ ] 2.3   CrÃ©er app/models.py - modÃ¨le CheckLog                              â”‚
â”‚ [ ] 2.4   CrÃ©er app/models.py - modÃ¨le Notification                          â”‚
â”‚ [ ] 2.5   VÃ©rifier les index dans les modÃ¨les SQLAlchemy                     â”‚
â”‚ [ ] 2.6   CrÃ©er app/schemas.py - DomainCreate, DomainUpdate                  â”‚
â”‚ [ ] 2.7   CrÃ©er app/schemas.py - DomainResponse, DomainList                  â”‚
â”‚ [ ] 2.8   CrÃ©er app/schemas.py - CheckLogResponse, StatsResponse             â”‚
â”‚ [ ] 2.9   DÃ©marrer MySQL avec docker compose up mysql -d et vÃ©rifier phpMyAdmin â”‚
â”‚ [ ] 2.10  COMMIT: "feat: database models and schemas for MySQL"              â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 2:                                            â”‚
â”‚   - MySQL dÃ©marre sans erreur                                                â”‚
â”‚   - phpMyAdmin accessible sur http://localhost:8083                          â”‚
â”‚   - Les 3 tables sont crÃ©Ã©es dans la base domain_monitor                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3 : SERVICE DNS CHECKER                                 [0/8] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 3.1   CrÃ©er app/services/__init__.py                                     â”‚
â”‚ [ ] 3.2   CrÃ©er app/services/dns_checker.py - structure de base              â”‚
â”‚ [ ] 3.3   ImplÃ©menter check_domain_availability()                            â”‚
â”‚ [ ] 3.4   ImplÃ©menter la gestion NXDOMAIN (domaine disponible)               â”‚
â”‚ [ ] 3.5   ImplÃ©menter la gestion timeout et retry                            â”‚
â”‚ [ ] 3.6   ImplÃ©menter la gestion multi-TLD (.fr, .com, .net)                 â”‚
â”‚ [ ] 3.7   Ajouter les logs Loguru dans le service                            â”‚
â”‚ [ ] 3.8   COMMIT: "feat: DNS checker service"                                â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 3:                                            â”‚
â”‚   - Test manuel: domaine existant (google.com) â†’ unavailable                 â”‚
â”‚   - Test manuel: domaine inexistant (xyzabc123456.com) â†’ available           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4 : SERVICE AVAILABILITY                                [0/7] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 4.1   CrÃ©er app/services/availability.py - structure de base             â”‚
â”‚ [ ] 4.2   ImplÃ©menter verify_domain() - premiÃ¨re vÃ©rification                â”‚
â”‚ [ ] 4.3   ImplÃ©menter la double vÃ©rification (dÃ©lai 5s + DNS secondaire)     â”‚
â”‚ [ ] 4.4   ImplÃ©menter la dÃ©tection de transition (previous_status)           â”‚
â”‚ [ ] 4.5   ImplÃ©menter la logique anti-spam (should_notify)                   â”‚
â”‚ [ ] 4.6   ImplÃ©menter la mise Ã  jour en base de donnÃ©es MySQL                â”‚
â”‚ [ ] 4.7   COMMIT: "feat: availability verification service"                  â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 4:                                            â”‚
â”‚   - Double vÃ©rification fonctionne                                           â”‚
â”‚   - Transition dÃ©tectÃ©e correctement                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5 : SERVICE NOTIFICATION DISCORD                        [0/8] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 5.1   CrÃ©er app/services/notification.py - structure de base             â”‚
â”‚ [ ] 5.2   ImplÃ©menter build_discord_embed() - construction du message        â”‚
â”‚ [ ] 5.3   ImplÃ©menter send_discord_notification() - envoi HTTP               â”‚
â”‚ [ ] 5.4   ImplÃ©menter le retry avec backoff exponentiel                      â”‚
â”‚ [ ] 5.5   ImplÃ©menter la gestion du rate limit Discord (429)                 â”‚
â”‚ [ ] 5.6   ImplÃ©menter l'enregistrement en base (table notifications)         â”‚
â”‚ [ ] 5.7   Ajouter fonction de test send_test_notification()                  â”‚
â”‚ [ ] 5.8   COMMIT: "feat: Discord notification service"                       â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 5:                                            â”‚
â”‚   - Notification de test reÃ§ue sur Discord                                   â”‚
â”‚   - Embed formatÃ© correctement avec tous les champs                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 6 : SERVICE SCHEDULER                                   [0/9] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 6.1   CrÃ©er app/services/scheduler.py - structure de base                â”‚
â”‚ [ ] 6.2   Configurer APScheduler (AsyncIOScheduler)                          â”‚
â”‚ [ ] 6.3   ImplÃ©menter run_check_cycle() - boucle principale                  â”‚
â”‚ [ ] 6.4   ImplÃ©menter le traitement par batch (BATCH_SIZE)                   â”‚
â”‚ [ ] 6.5   ImplÃ©menter le dÃ©lai entre chaque domaine                          â”‚
â”‚ [ ] 6.6   ImplÃ©menter les logs de dÃ©but/fin de cycle avec stats              â”‚
â”‚ [ ] 6.7   ImplÃ©menter l'appel Ã  la procÃ©dure MySQL cleanup_old_logs()        â”‚
â”‚ [ ] 6.8   Ajouter fonctions start_scheduler() et shutdown_scheduler()        â”‚
â”‚ [ ] 6.9   COMMIT: "feat: APScheduler job configuration"                      â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 6:                                            â”‚
â”‚   - Le scheduler dÃ©marre sans erreur                                         â”‚
â”‚   - Les logs montrent le cycle de vÃ©rification                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 7 : API REST - ROUTES                                   [0/14] â¬œ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 7.1   CrÃ©er app/routers/__init__.py                                      â”‚
â”‚ [ ] 7.2   CrÃ©er app/routers/domains.py - structure de base                   â”‚
â”‚ [ ] 7.3   ImplÃ©menter GET /api/health (avec check connexion MySQL)           â”‚
â”‚ [ ] 7.4   ImplÃ©menter GET /api/stats                                         â”‚
â”‚ [ ] 7.5   ImplÃ©menter GET /api/domains (liste avec filtres et pagination)    â”‚
â”‚ [ ] 7.6   ImplÃ©menter GET /api/domains/{id} (dÃ©tails + derniers checks)      â”‚
â”‚ [ ] 7.7   ImplÃ©menter POST /api/domains (crÃ©ation avec validation)           â”‚
â”‚ [ ] 7.8   ImplÃ©menter PUT /api/domains/{id} (modification)                   â”‚
â”‚ [ ] 7.9   ImplÃ©menter DELETE /api/domains/{id} (suppression)                 â”‚
â”‚ [ ] 7.10  ImplÃ©menter POST /api/domains/{id}/check (forcer vÃ©rification)     â”‚
â”‚ [ ] 7.11  ImplÃ©menter PATCH /api/domains/{id}/toggle (activer/dÃ©sactiver)    â”‚
â”‚ [ ] 7.12  Ajouter la validation TLD supportÃ©s                                â”‚
â”‚ [ ] 7.13  Ajouter la gestion des erreurs (HTTPException)                     â”‚
â”‚ [ ] 7.14  COMMIT: "feat: REST API endpoints"                                 â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 7:                                            â”‚
â”‚   - Tous les endpoints rÃ©pondent correctement                                â”‚
â”‚   - La validation rejette les donnÃ©es invalides                              â”‚
â”‚   - Les erreurs retournent du JSON structurÃ©                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 8 : APPLICATION PRINCIPALE                              [0/7] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 8.1   CrÃ©er app/main.py - structure FastAPI de base                      â”‚
â”‚ [ ] 8.2   Configurer Loguru (fichiers + console + rotation)                  â”‚
â”‚ [ ] 8.3   Ajouter les Ã©vÃ©nements startup (init DB MySQL + scheduler)         â”‚
â”‚ [ ] 8.4   Ajouter les Ã©vÃ©nements shutdown (arrÃªt scheduler + fermeture DB)   â”‚
â”‚ [ ] 8.5   Inclure le router domains                                          â”‚
â”‚ [ ] 8.6   Ajouter le middleware CORS (optionnel)                             â”‚
â”‚ [ ] 8.7   COMMIT: "feat: FastAPI main application"                           â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 8:                                            â”‚
â”‚   - L'application dÃ©marre avec uvicorn                                       â”‚
â”‚   - /api/health retourne {"status": "healthy", "database": "connected"}      â”‚
â”‚   - Les logs sont Ã©crits dans ./logs/                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 9 : TESTS                                               [0/8] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 9.1   CrÃ©er tests/__init__.py                                            â”‚
â”‚ [ ] 9.2   CrÃ©er tests/conftest.py (fixtures: client, db mock, mocks)         â”‚
â”‚ [ ] 9.3   CrÃ©er tests/test_dns_checker.py (3+ tests)                         â”‚
â”‚ [ ] 9.4   CrÃ©er tests/test_availability.py (3+ tests)                        â”‚
â”‚ [ ] 9.5   CrÃ©er tests/test_api.py - tests endpoints (5+ tests)               â”‚
â”‚ [ ] 9.6   Ajouter les mocks pour DNS et Discord                              â”‚
â”‚ [ ] 9.7   VÃ©rifier que tous les tests passent                                â”‚
â”‚ [ ] 9.8   COMMIT: "test: unit and integration tests"                         â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 9:                                            â”‚
â”‚   - pytest passe sans erreur                                                 â”‚
â”‚   - Couverture > 70%                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 10 : DOCUMENTATION                                      [0/6] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 10.1  CrÃ©er README.md complet                                            â”‚
â”‚ [ ] 10.2  CrÃ©er DEPLOYMENT.md (commandes VPS + accÃ¨s phpMyAdmin)             â”‚
â”‚ [ ] 10.3  CrÃ©er scripts/seed.py (donnÃ©es de test)                            â”‚
â”‚ [ ] 10.4  VÃ©rifier les docstrings dans tous les fichiers                     â”‚
â”‚ [ ] 10.5  VÃ©rifier que .gitignore exclut .env et mysql_data/                 â”‚
â”‚ [ ] 10.6  COMMIT: "docs: README and deployment guide"                        â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 10:                                           â”‚
â”‚   - README contient: description, install, config, usage                     â”‚
â”‚   - DEPLOYMENT contient les commandes Docker + accÃ¨s phpMyAdmin              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 11 : BUILD & VALIDATION DOCKER                          [0/7] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 11.1  CrÃ©er le fichier .env avec vraies valeurs (webhook Discord, MySQL) â”‚
â”‚ [ ] 11.2  Build Docker: docker compose build                                 â”‚
â”‚ [ ] 11.3  DÃ©marrer tous les services: docker compose up -d                   â”‚
â”‚ [ ] 11.4  VÃ©rifier les logs: docker compose logs -f                          â”‚
â”‚ [ ] 11.5  VÃ©rifier phpMyAdmin: http://localhost:8083                         â”‚
â”‚ [ ] 11.6  Tester les endpoints avec curl                                     â”‚
â”‚ [ ] 11.7  COMMIT: "chore: Docker build validated"                            â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 11:                                           â”‚
â”‚   - Les 3 containers dÃ©marrent sans erreur                                   â”‚
â”‚   - Health check passe                                                       â”‚
â”‚   - phpMyAdmin montre les tables                                             â”‚
â”‚   - API rÃ©pond correctement                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 12 : TESTS D'INTÃ‰GRATION COMPLETS                       [0/5] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 12.1  Ajouter un domaine via API                                         â”‚
â”‚ [ ] 12.2  VÃ©rifier dans phpMyAdmin que le domaine est en base                â”‚
â”‚ [ ] 12.3  Forcer une vÃ©rification via API                                    â”‚
â”‚ [ ] 12.4  VÃ©rifier dans phpMyAdmin que le check_log est crÃ©Ã©                 â”‚
â”‚ [ ] 12.5  COMMIT: "test: integration tests passed"                           â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 12:                                           â”‚
â”‚   - Flow complet fonctionne de bout en bout                                  â”‚
â”‚   - DonnÃ©es visibles dans phpMyAdmin                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 13 : GIT & GITHUB                                       [0/3] â¬œ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] 13.1  VÃ©rifier l'historique des commits (git log --oneline)              â”‚
â”‚ [ ] 13.2  CrÃ©er le repository GitHub 'saas-nomdedomaine'                     â”‚
â”‚ [ ] 13.3  Push final: git remote add origin + git push -u origin main        â”‚
â”‚                                                                              â”‚
â”‚ âœ“ CritÃ¨res de validation Phase 13:                                           â”‚
â”‚   - Code visible sur GitHub                                                  â”‚
â”‚   - Aucun fichier sensible (.env, mysql_data/) dans le repo                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              FIN DE LA CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

# SECTION 7 : FICHIERS README ET DEPLOYMENT

## 7.1 README.md (template)

```markdown
# ğŸ” Domain Monitor - SaaS Monitoring Domaines ExpirÃ©s

Application de surveillance de domaines expirÃ©s avec notifications Discord.

## ğŸš€ FonctionnalitÃ©s

- Surveillance automatique de domaines expirÃ©s (toutes les 2h)
- Double vÃ©rification DNS pour Ã©viter les faux positifs
- Notifications Discord lors de la disponibilitÃ©
- API REST complÃ¨te pour la gestion des domaines
- Support des extensions .fr, .com, .net
- Interface phpMyAdmin pour administrer la base de donnÃ©es

## ğŸ› ï¸ Stack Technique

- **Backend**: Python 3.12 + FastAPI
- **Base de donnÃ©es**: MySQL 8.0 + phpMyAdmin
- **Scheduler**: APScheduler
- **DNS**: dnspython
- **Conteneurisation**: Docker + Docker Compose

## ğŸ“¦ Installation

### PrÃ©requis

- Docker et Docker Compose installÃ©s
- Un webhook Discord

### DÃ©ploiement

1. Cloner le repository:
```bash
git clone https://github.com/VOTRE_USERNAME/saas-nomdedomaine.git
cd saas-nomdedomaine
```

2. Configurer l'environnement:
```bash
cp .env.example .env
nano .env  # Configurer les variables
```

3. DÃ©marrer l'application:
```bash
docker compose up -d --build
```

4. VÃ©rifier le status:
```bash
docker compose ps
docker compose logs -f
```

## ğŸŒ AccÃ¨s aux services

| Service | URL | Description |
|---------|-----|-------------|
| API | http://localhost:3010 | API REST FastAPI |
| phpMyAdmin | http://localhost:8083 | Administration MySQL |
| Docs API | http://localhost:3010/docs | Documentation Swagger |

## ğŸ”Œ API Endpoints

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | /api/health | Health check |
| GET | /api/stats | Statistiques |
| GET | /api/domains | Lister les domaines |
| POST | /api/domains | Ajouter un domaine |
| DELETE | /api/domains/{id} | Supprimer un domaine |
| POST | /api/domains/{id}/check | Forcer vÃ©rification |

## ğŸ“ Exemples d'utilisation

### Ajouter un domaine
```bash
curl -X POST http://localhost:3010/api/domains \
  -H "Content-Type: application/json" \
  -d '{
    "domain": "example.fr",
    "niche": "Tech",
    "traffic": 5000,
    "referring_domains": 150
  }'
```

### Lister les domaines
```bash
curl http://localhost:3010/api/domains
```

## ğŸ“ Structure du projet

```
saas-nomdedomaine/
â”œâ”€â”€ app/                 # Code applicatif
â”œâ”€â”€ tests/               # Tests unitaires
â”œâ”€â”€ scripts/             # Scripts SQL et seed
â”œâ”€â”€ logs/                # Fichiers de logs
â”œâ”€â”€ docker/              # Dockerfile
â””â”€â”€ docker-compose.yml
```

## ğŸ“„ License

MIT
```

## 7.2 DEPLOYMENT.md (template)

```markdown
# ğŸš€ Guide de DÃ©ploiement - Domain Monitor

## Connexion VPS

```bash
ssh ubuntu@37.59.125.246
```

## Emplacement du projet

```bash
cd ~/saas-nomdedomaine
```

---

## Services et Ports

| Service | Port | URL |
|---------|------|-----|
| Application FastAPI | 3010 | http://localhost:3010 |
| phpMyAdmin | 8083 | http://localhost:8083 |
| MySQL | 3307 | (interne Docker) |

---

## Commandes Docker

### Voir l'Ã©tat des containers
```bash
docker compose ps
```

### Voir les logs en temps rÃ©el
```bash
docker compose logs -f
```

### Logs d'un service spÃ©cifique
```bash
docker compose logs -f app          # Application FastAPI
docker compose logs -f mysql        # Base de donnÃ©es
docker compose logs -f phpmyadmin   # phpMyAdmin
```

### RedÃ©marrer tous les services
```bash
docker compose restart
```

### RedÃ©marrer un service spÃ©cifique
```bash
docker compose restart app
```

### ArrÃªter tous les services
```bash
docker compose down
```

### DÃ©marrer tous les services
```bash
docker compose up -d
```

### Rebuild aprÃ¨s modification du code
```bash
git pull origin main
docker compose up -d --build
```

---

## AccÃ¨s phpMyAdmin

- **URL**: http://localhost:8083 (ou http://IP_VPS:8083)
- **Serveur**: mysql
- **Utilisateur**: root
- **Mot de passe**: (valeur de MYSQL_ROOT_PASSWORD dans .env)

---

## Commandes API

### Health check
```bash
curl http://localhost:3010/api/health
```

### Statistiques
```bash
curl http://localhost:3010/api/stats
```

### Lister les domaines
```bash
curl http://localhost:3010/api/domains
```

### Ajouter un domaine
```bash
curl -X POST http://localhost:3010/api/domains \
  -H "Content-Type: application/json" \
  -d '{"domain": "example.fr", "niche": "Tech", "traffic": 5000, "referring_domains": 150}'
```

### Forcer une vÃ©rification
```bash
curl -X POST http://localhost:3010/api/domains/1/check
```

---

## AccÃ¨s MySQL en ligne de commande

```bash
docker compose exec mysql mysql -u root -p domain_monitor
```

### RequÃªtes utiles

```sql
-- Voir tous les domaines
SELECT * FROM domains;

-- Voir les domaines disponibles
SELECT * FROM domains WHERE status = 'available';

-- Voir les derniÃ¨res vÃ©rifications
SELECT * FROM check_logs ORDER BY checked_at DESC LIMIT 20;

-- Voir les notifications envoyÃ©es
SELECT * FROM notifications ORDER BY sent_at DESC LIMIT 20;

-- Compter les domaines par status
SELECT status, COUNT(*) FROM domains GROUP BY status;
```

---

## DÃ©pannage

### Voir les derniers logs d'erreur
```bash
docker compose logs --tail=100 app
```

### VÃ©rifier la connexion MySQL
```bash
docker compose exec mysql mysqladmin ping -h localhost -u root -p
```

### AccÃ©der au container app
```bash
docker compose exec app bash
```

### RedÃ©marrage complet (avec suppression des volumes)
```bash
docker compose down -v
docker compose up -d --build
```

âš ï¸ **Attention**: `docker compose down -v` supprime les donnÃ©es MySQL !

---

## Backup de la base de donnÃ©es

### CrÃ©er un backup
```bash
docker compose exec mysql mysqldump -u root -p domain_monitor > backup_$(date +%Y%m%d).sql
```

### Restaurer un backup
```bash
docker compose exec -T mysql mysql -u root -p domain_monitor < backup_20250119.sql
```

---

## Fichiers importants

| Fichier | Description |
|---------|-------------|
| `.env` | Configuration (ne pas commiter) |
| `logs/app.log` | Logs application |
| `scripts/init.sql` | Script d'initialisation MySQL |
```

---

# SECTION 8 : INSTRUCTIONS FINALES

## RÃ©sumÃ© des rÃ¨gles de travail

1. **ExÃ©cuter chaque tÃ¢che dans l'ordre** de la checklist
2. **AprÃ¨s chaque sous-tÃ¢che**, afficher la checklist mise Ã  jour avec le pourcentage
3. **Tester chaque composant** avant de passer au suivant
4. **Faire un commit Git** Ã  la fin de chaque phase
5. **Ne jamais sauter d'Ã©tape** mÃªme si elle semble triviale
6. **En cas d'erreur**, corriger avant de continuer

## RÃ©capitulatif des ports

| Service | Port |
|---------|------|
| Application FastAPI | 3010 |
| phpMyAdmin | 8083 |
| MySQL (interne Docker) | 3307 |

## Commande de dÃ©marrage

Commence maintenant par la **Phase 1, TÃ¢che 1.1** : CrÃ©er le dossier racine 'saas-nomdedomaine'.

AprÃ¨s chaque tÃ¢che, montre-moi la checklist mise Ã  jour.

---

**ğŸš€ DÃ‰BUT DU DÃ‰VELOPPEMENT - PHASE 1, TÃ‚CHE 1.1**